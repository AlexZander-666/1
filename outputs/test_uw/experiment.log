2025-12-18 21:46:46,592 - INFO - Logging initialized. Output directory: outputs/test_uw
2025-12-18 21:46:47,954 - INFO - Optimized Config: {'dataset': 'dryrun', 'data_root': './data', 'out_dir': 'outputs/test_uw', 'model': 'amsv2', 'epochs': 1, 'batch_size': 4, 'lr': 0.001, 'warmup_epochs': 5, 'accum_steps': 1, 'channels': 64, 'n_blocks': 4, 'kernel_sizes': [7, 15, 31, 63], 'freq_method': 'fft', 'fusion_variant': 'enhanced', 'fusion_kernel_sizes': (3, 5, 7), 'num_bands': 4, 'band_edges': None, 'adaptive_bands': True, 'attn_time': 'none', 'attn_freq': 'none', 'attn_fuse': 'none', 'attn_lite': 'none', 'faa_axis_attn': True, 'num_workers': 0, 'num_classes': 2, 'in_channels': 3, 'patience': 15, 'window_size': 512, 'stride': 256, 'channels_used': 'accel3', 'augment': False, 'noise_std': 0.05, 'scale_range': [0.9, 1.1], 'time_shift_ratio': 0.1, 'drop_prob': 0.1, 'eval_mode': 'holdout', 'seeds': [42], 'amp': False, 'weighted_loss': False, 'class_weighting': None, 'effective_num_beta': 0.999, 'profile': False, 'run_robustness': False, 'run_ablation_suite': False, 'allow_metrics_fallback': False, 'viz_tsne': False, 'viz_tsne_stage': 'final', 'viz_routing': False, 'viz_gradcam': False, 'loso_max_folds': None, 'deterministic': False, 'use_tfcl': True, 'ablation': {'mspa': True, 'dks': True, 'faa': True, 'tfcl': True, 'center': True}, 'proj_dim': 128, 'tf_temperature': 0.1, 'tf_supervised_weight': 0.1, 'tf_cross_weight': 0.3, 'tf_hierarchical': True, 'label_smoothing': 0.0, 'min_patience': 5, 'patience_decay': 0.9, 'loss_alpha': 0.1, 'loss_beta': 0.01, 'uncertainty_weighting': True, 'rocket_kernels': 256, 'rocket_kernel_size': 9, 'lstm_hidden': 128, 'stat_baseline': None, 'sample_rate': 50.0, 'cross_eval': False, 'resume': None}
2025-12-18 21:46:47,958 - INFO - Seed set to 42 (deterministic=False)
2025-12-18 21:46:48,548 - INFO - [main] Model: amsv2
2025-12-18 21:46:48,548 - INFO - [main]   Total params: 1.65M
2025-12-18 21:46:48,548 - INFO - [main]   Trainable params: 1.65M
2025-12-18 21:46:52,331 - INFO - [main] Using uncertainty weighting (Kendall et al.) for automatic loss balancing
2025-12-18 21:46:52,333 - INFO - [main] Starting training: epochs=1, batch_size=4, num_workers=0, train_samples=200
2025-12-18 21:47:21,394 - DEBUG - Eval predictions unique: [0 1], counts: [24 26]
2025-12-18 21:47:21,394 - DEBUG - Eval labels unique: [0 1], counts: [20 30]
2025-12-18 21:47:21,399 - DEBUG - Eval confusion matrix:
[[13  7]
 [11 19]]
2025-12-18 21:47:21,399 - DEBUG - Manual metrics - Acc: 0.6400, Macro F1: 0.6347, Fall F1: 0.6786
2025-12-18 21:47:21,402 - DEBUG - Accuracy: 0.6400
2025-12-18 21:47:21,422 - DEBUG - F1 scores - Macro: 0.6347, Class0: 0.5909, Class1: 0.6786
2025-12-18 21:47:23,054 - INFO - [main] Seed 42 | Ep 1: Loss=4.0087 (ce=0.7022 tfcl_layer0=1.3667 tfcl_cross0->1=1.3783 tfcl_layer1=1.3807 tfcl_cross1->2=1.3953 tfcl_layer2=1.3877 tfcl_cross2->3=1.3869 tfcl_layer3=1.3800 tfcl_cross3->4=1.3876 tfcl_layer4=1.3592 tfcl_cross4->5=1.3999 tfcl_layer5=1.3934 tfcl_sup=1.3186 tfcl_total=1.7473 center=1.5591 task0_weight=1.0000 task0_sigma=1.0000 task0_weighted=0.7022 task1_weight=1.0000 task1_sigma=1.0000 task1_weighted=1.7473 task2_weight=1.0000 task2_sigma=1.0000 task2_weighted=1.5591 total_uncertainty=4.0087 uw_ce=1.0000 uw_tfcl=1.0000 uw_center=1.0000) Val_F1=0.6347 Best_F1=0.6347
2025-12-18 21:47:24,664 - INFO - [main] Loaded best checkpoint from epoch 1
2025-12-18 21:47:26,379 - DEBUG - Eval predictions unique: [0 1], counts: [21 29]
2025-12-18 21:47:26,380 - DEBUG - Eval labels unique: [0 1], counts: [24 26]
2025-12-18 21:47:26,383 - DEBUG - Eval confusion matrix:
[[11 13]
 [10 16]]
2025-12-18 21:47:26,384 - DEBUG - Manual metrics - Acc: 0.5400, Macro F1: 0.5354, Fall F1: 0.5818
2025-12-18 21:47:26,386 - DEBUG - Accuracy: 0.5400
2025-12-18 21:47:26,404 - DEBUG - F1 scores - Macro: 0.5354, Class0: 0.4889, Class1: 0.5818
2025-12-18 21:47:26,446 - INFO - [main] Seed 42 Test Results: {'accuracy': 0.54, 'specificity': 0.4583333333333333, 'fall_f1': 0.5818181818181818, 'sensitivity': 0.6153846153846154, 'macro_f1': 0.5353535353535354, 'recall_macro': 0.5368589743589743, 'precision': 0.5377668308702792, 'balanced_accuracy': 0.5368589743589743, 'roc_auc': 0.467948717948718, 'pr_auc': 0.5166934230433736, 'mcc': 0.07462028278336501, 'g_mean': 0.5310850045437944, 'false_alarm_rate': 0.5416666666666441, 'detection_latency_ms': 3258.181818181818, 'detection_latency_median_ms': 0.0, 'detection_latency_std_ms': 5013.098875005211, 'detection_latency_min_ms': 0.0, 'detection_latency_max_ms': 15360.0, 'detection_rate': 1.0, 'detection_total_falls': 11, 'detection_detected_falls': 11}
2025-12-18 21:47:26,449 - INFO - Saved confusion matrix to outputs/test_uw\confusion_matrix_seed42_main.npy
2025-12-18 21:47:26,451 - INFO - Saved error analysis to outputs/test_uw\errors_seed42_main.csv
2025-12-18 21:47:26,475 - INFO - Saved split stats to outputs/test_uw\split_stats_seed42.json
2025-12-18 21:47:26,484 - INFO - Final Summary: {
  "accuracy_mean": 0.54,
  "accuracy_std": 0.0,
  "accuracy_se": NaN,
  "accuracy_n": 1,
  "accuracy_95ci": null,
  "accuracy_ci_lower": null,
  "accuracy_ci_upper": null,
  "balanced_accuracy_mean": 0.5368589743589743,
  "balanced_accuracy_std": 0.0,
  "balanced_accuracy_se": NaN,
  "balanced_accuracy_n": 1,
  "balanced_accuracy_95ci": null,
  "balanced_accuracy_ci_lower": null,
  "balanced_accuracy_ci_upper": null,
  "detection_detected_falls_mean": 11.0,
  "detection_detected_falls_std": 0.0,
  "detection_detected_falls_se": NaN,
  "detection_detected_falls_n": 1,
  "detection_detected_falls_95ci": null,
  "detection_detected_falls_ci_lower": null,
  "detection_detected_falls_ci_upper": null,
  "detection_latency_max_ms_mean": 15360.0,
  "detection_latency_max_ms_std": 0.0,
  "detection_latency_max_ms_se": NaN,
  "detection_latency_max_ms_n": 1,
  "detection_latency_max_ms_95ci": null,
  "detection_latency_max_ms_ci_lower": null,
  "detection_latency_max_ms_ci_upper": null,
  "detection_latency_median_ms_mean": 0.0,
  "detection_latency_median_ms_std": 0.0,
  "detection_latency_median_ms_se": NaN,
  "detection_latency_median_ms_n": 1,
  "detection_latency_median_ms_95ci": null,
  "detection_latency_median_ms_ci_lower": null,
  "detection_latency_median_ms_ci_upper": null,
  "detection_latency_min_ms_mean": 0.0,
  "detection_latency_min_ms_std": 0.0,
  "detection_latency_min_ms_se": NaN,
  "detection_latency_min_ms_n": 1,
  "detection_latency_min_ms_95ci": null,
  "detection_latency_min_ms_ci_lower": null,
  "detection_latency_min_ms_ci_upper": null,
  "detection_latency_ms_mean": 3258.181818181818,
  "detection_latency_ms_std": 0.0,
  "detection_latency_ms_se": NaN,
  "detection_latency_ms_n": 1,
  "detection_latency_ms_95ci": null,
  "detection_latency_ms_ci_lower": null,
  "detection_latency_ms_ci_upper": null,
  "detection_latency_std_ms_mean": 5013.098875005211,
  "detection_latency_std_ms_std": 0.0,
  "detection_latency_std_ms_se": NaN,
  "detection_latency_std_ms_n": 1,
  "detection_latency_std_ms_95ci": null,
  "detection_latency_std_ms_ci_lower": null,
  "detection_latency_std_ms_ci_upper": null,
  "detection_rate_mean": 1.0,
  "detection_rate_std": 0.0,
  "detection_rate_se": NaN,
  "detection_rate_n": 1,
  "detection_rate_95ci": null,
  "detection_rate_ci_lower": null,
  "detection_rate_ci_upper": null,
  "detection_total_falls_mean": 11.0,
  "detection_total_falls_std": 0.0,
  "detection_total_falls_se": NaN,
  "detection_total_falls_n": 1,
  "detection_total_falls_95ci": null,
  "detection_total_falls_ci_lower": null,
  "detection_total_falls_ci_upper": null,
  "fall_f1_mean": 0.5818181818181818,
  "fall_f1_std": 0.0,
  "fall_f1_se": NaN,
  "fall_f1_n": 1,
  "fall_f1_95ci": null,
  "fall_f1_ci_lower": null,
  "fall_f1_ci_upper": null,
  "false_alarm_rate_mean": 0.5416666666666441,
  "false_alarm_rate_std": 0.0,
  "false_alarm_rate_se": NaN,
  "false_alarm_rate_n": 1,
  "false_alarm_rate_95ci": null,
  "false_alarm_rate_ci_lower": null,
  "false_alarm_rate_ci_upper": null,
  "g_mean_mean": 0.5310850045437944,
  "g_mean_std": 0.0,
  "g_mean_se": NaN,
  "g_mean_n": 1,
  "g_mean_95ci": null,
  "g_mean_ci_lower": null,
  "g_mean_ci_upper": null,
  "macro_f1_mean": 0.5353535353535354,
  "macro_f1_std": 0.0,
  "macro_f1_se": NaN,
  "macro_f1_n": 1,
  "macro_f1_95ci": null,
  "macro_f1_ci_lower": null,
  "macro_f1_ci_upper": null,
  "mcc_mean": 0.07462028278336501,
  "mcc_std": 0.0,
  "mcc_se": NaN,
  "mcc_n": 1,
  "mcc_95ci": null,
  "mcc_ci_lower": null,
  "mcc_ci_upper": null,
  "pr_auc_mean": 0.5166934230433736,
  "pr_auc_std": 0.0,
  "pr_auc_se": NaN,
  "pr_auc_n": 1,
  "pr_auc_95ci": null,
  "pr_auc_ci_lower": null,
  "pr_auc_ci_upper": null,
  "precision_mean": 0.5377668308702792,
  "precision_std": 0.0,
  "precision_se": NaN,
  "precision_n": 1,
  "precision_95ci": null,
  "precision_ci_lower": null,
  "precision_ci_upper": null,
  "recall_macro_mean": 0.5368589743589743,
  "recall_macro_std": 0.0,
  "recall_macro_se": NaN,
  "recall_macro_n": 1,
  "recall_macro_95ci": null,
  "recall_macro_ci_lower": null,
  "recall_macro_ci_upper": null,
  "roc_auc_mean": 0.467948717948718,
  "roc_auc_std": 0.0,
  "roc_auc_se": NaN,
  "roc_auc_n": 1,
  "roc_auc_95ci": null,
  "roc_auc_ci_lower": null,
  "roc_auc_ci_upper": null,
  "sensitivity_mean": 0.6153846153846154,
  "sensitivity_std": 0.0,
  "sensitivity_se": NaN,
  "sensitivity_n": 1,
  "sensitivity_95ci": null,
  "sensitivity_ci_lower": null,
  "sensitivity_ci_upper": null,
  "specificity_mean": 0.4583333333333333,
  "specificity_std": 0.0,
  "specificity_se": NaN,
  "specificity_n": 1,
  "specificity_95ci": null,
  "specificity_ci_lower": null,
  "specificity_ci_upper": null
}
