2025-12-18 13:55:11,402 - INFO - Logging initialized. Output directory: ./outputs
2025-12-18 13:55:12,374 - INFO - Optimized Config: {'dataset': 'dryrun', 'data_root': './data', 'out_dir': './outputs', 'model': 'dmc', 'epochs': 2, 'batch_size': 4, 'lr': 0.001, 'warmup_epochs': 5, 'accum_steps': 1, 'channels': 64, 'n_blocks': 4, 'kernel_sizes': [7, 15, 31, 63], 'freq_method': 'fft', 'fusion_variant': 'enhanced', 'fusion_kernel_sizes': (3, 5, 7), 'num_bands': 4, 'band_edges': None, 'adaptive_bands': True, 'attn_time': 'none', 'attn_freq': 'none', 'attn_fuse': 'none', 'attn_lite': 'none', 'faa_axis_attn': True, 'num_workers': 0, 'num_classes': 2, 'in_channels': 3, 'patience': 15, 'window_size': 512, 'stride': 256, 'channels_used': 'accel3', 'augment': False, 'noise_std': 0.05, 'scale_range': [0.9, 1.1], 'time_shift_ratio': 0.1, 'drop_prob': 0.1, 'eval_mode': 'holdout', 'seeds': [42], 'amp': False, 'weighted_loss': False, 'profile': True, 'run_robustness': False, 'run_ablation_suite': False, 'allow_metrics_fallback': False, 'viz_tsne': False, 'viz_tsne_stage': 'final', 'viz_routing': False, 'viz_gradcam': False, 'loso_max_folds': None, 'deterministic': False, 'use_tfcl': False, 'ablation': {'mspa': True, 'dks': True, 'faa': True, 'tfcl': True, 'center': True}, 'proj_dim': 128, 'tf_temperature': 0.1, 'tf_supervised_weight': 0.1, 'tf_cross_weight': 0.3, 'tf_hierarchical': True, 'label_smoothing': 0.0, 'min_patience': 5, 'patience_decay': 0.9, 'loss_alpha': 0.1, 'loss_beta': 0.01, 'rocket_kernels': 256, 'rocket_kernel_size': 9, 'lstm_hidden': 128, 'stat_baseline': None, 'sample_rate': 50.0, 'cross_eval': False, 'resume': None}
2025-12-18 13:55:12,375 - INFO - Seed set to 42 (deterministic=False)
2025-12-18 13:55:12,810 - INFO - [main] Model: dmc
2025-12-18 13:55:12,810 - INFO - [main]   Total params: 0.25M
2025-12-18 13:55:12,810 - INFO - [main]   Trainable params: 0.25M
2025-12-18 13:55:14,603 - INFO - [main] Starting training: epochs=2, batch_size=4, num_workers=0, train_samples=200
2025-12-18 13:55:26,581 - DEBUG - Eval predictions unique: [1], counts: [ 0 50]
2025-12-18 13:55:26,582 - DEBUG - Eval labels unique: [0 1], counts: [20 30]
2025-12-18 13:55:26,585 - DEBUG - Eval confusion matrix:
[[ 0 20]
 [ 0 30]]
2025-12-18 13:55:26,585 - DEBUG - Manual metrics - Acc: 0.6000, Macro F1: 0.3750, Fall F1: 0.7500
2025-12-18 13:55:26,586 - DEBUG - Accuracy: 0.6000
2025-12-18 13:55:26,597 - DEBUG - F1 scores - Macro: 0.3750, Class0: 0.0000, Class1: 0.7500
2025-12-18 13:55:27,039 - INFO - [main] Seed 42 | Ep 1: Loss=0.7032 (ce=0.7032) Val_F1=0.3750 Best_F1=0.3750
2025-12-18 13:55:35,288 - DEBUG - Eval predictions unique: [1], counts: [ 0 50]
2025-12-18 13:55:35,288 - DEBUG - Eval labels unique: [0 1], counts: [20 30]
2025-12-18 13:55:35,290 - DEBUG - Eval confusion matrix:
[[ 0 20]
 [ 0 30]]
2025-12-18 13:55:35,290 - DEBUG - Manual metrics - Acc: 0.6000, Macro F1: 0.3750, Fall F1: 0.7500
2025-12-18 13:55:35,292 - DEBUG - Accuracy: 0.6000
2025-12-18 13:55:35,301 - DEBUG - F1 scores - Macro: 0.3750, Class0: 0.0000, Class1: 0.7500
2025-12-18 13:55:35,532 - INFO - [main] Seed 42 | Ep 2: Loss=0.6956 (ce=0.6956) Val_F1=0.3750 Best_F1=0.3750
2025-12-18 13:55:36,050 - INFO - [main] Loaded best checkpoint from epoch 1
2025-12-18 13:55:36,693 - DEBUG - Eval predictions unique: [1], counts: [ 0 50]
2025-12-18 13:55:36,693 - DEBUG - Eval labels unique: [0 1], counts: [24 26]
2025-12-18 13:55:36,695 - DEBUG - Eval confusion matrix:
[[ 0 24]
 [ 0 26]]
2025-12-18 13:55:36,695 - DEBUG - Manual metrics - Acc: 0.5200, Macro F1: 0.3421, Fall F1: 0.6842
2025-12-18 13:55:36,696 - DEBUG - Accuracy: 0.5200
2025-12-18 13:55:36,706 - DEBUG - F1 scores - Macro: 0.3421, Class0: 0.0000, Class1: 0.6842
2025-12-18 13:55:36,729 - INFO - [main] Seed 42 Test Results: {'accuracy': 0.52, 'specificity': 0.0, 'fall_f1': 0.6842105263157895, 'sensitivity': 1.0, 'macro_f1': 0.34210526315789475, 'recall_macro': 0.5, 'precision': 0.26, 'balanced_accuracy': 0.5, 'roc_auc': 0.7371794871794872, 'pr_auc': 0.7033442446617859, 'mcc': 0.0, 'g_mean': 0.0, 'false_alarm_rate': 0.9999999999999584, 'detection_latency_ms': 0.0, 'detection_latency_median_ms': 0.0, 'detection_latency_std_ms': 0.0, 'detection_latency_min_ms': 0.0, 'detection_latency_max_ms': 0.0, 'detection_rate': 1.0, 'detection_total_falls': 11, 'detection_detected_falls': 11}
2025-12-18 13:55:36,732 - INFO - Saved confusion matrix to ./outputs\confusion_matrix_seed42_main.npy
2025-12-18 13:55:36,733 - INFO - Saved error analysis to ./outputs\errors_seed42_main.csv
2025-12-18 13:55:42,733 - INFO - ------------------------------
2025-12-18 13:55:42,733 - INFO - [Efficiency Report] Input: (1, 3, 512)
2025-12-18 13:55:42,733 - INFO -   - Params: 0.25 M
2025-12-18 13:55:42,733 - INFO -   - FLOPs: 0.097 G
2025-12-18 13:55:42,733 - INFO -   - Latency: 47.122 ms
2025-12-18 13:55:42,733 - INFO - ------------------------------
2025-12-18 13:55:42,734 - INFO - Saved efficiency report to ./outputs\efficiency_seed42.json
2025-12-18 13:55:42,741 - INFO - Saved split stats to ./outputs\split_stats_seed42.json
2025-12-18 13:55:42,743 - INFO - Final Summary: {
  "accuracy_mean": 0.52,
  "accuracy_std": 0.0,
  "accuracy_se": NaN,
  "accuracy_n": 1,
  "accuracy_95ci": null,
  "accuracy_ci_lower": null,
  "accuracy_ci_upper": null,
  "balanced_accuracy_mean": 0.5,
  "balanced_accuracy_std": 0.0,
  "balanced_accuracy_se": NaN,
  "balanced_accuracy_n": 1,
  "balanced_accuracy_95ci": null,
  "balanced_accuracy_ci_lower": null,
  "balanced_accuracy_ci_upper": null,
  "detection_detected_falls_mean": 11.0,
  "detection_detected_falls_std": 0.0,
  "detection_detected_falls_se": NaN,
  "detection_detected_falls_n": 1,
  "detection_detected_falls_95ci": null,
  "detection_detected_falls_ci_lower": null,
  "detection_detected_falls_ci_upper": null,
  "detection_latency_max_ms_mean": 0.0,
  "detection_latency_max_ms_std": 0.0,
  "detection_latency_max_ms_se": NaN,
  "detection_latency_max_ms_n": 1,
  "detection_latency_max_ms_95ci": null,
  "detection_latency_max_ms_ci_lower": null,
  "detection_latency_max_ms_ci_upper": null,
  "detection_latency_median_ms_mean": 0.0,
  "detection_latency_median_ms_std": 0.0,
  "detection_latency_median_ms_se": NaN,
  "detection_latency_median_ms_n": 1,
  "detection_latency_median_ms_95ci": null,
  "detection_latency_median_ms_ci_lower": null,
  "detection_latency_median_ms_ci_upper": null,
  "detection_latency_min_ms_mean": 0.0,
  "detection_latency_min_ms_std": 0.0,
  "detection_latency_min_ms_se": NaN,
  "detection_latency_min_ms_n": 1,
  "detection_latency_min_ms_95ci": null,
  "detection_latency_min_ms_ci_lower": null,
  "detection_latency_min_ms_ci_upper": null,
  "detection_latency_ms_mean": 0.0,
  "detection_latency_ms_std": 0.0,
  "detection_latency_ms_se": NaN,
  "detection_latency_ms_n": 1,
  "detection_latency_ms_95ci": null,
  "detection_latency_ms_ci_lower": null,
  "detection_latency_ms_ci_upper": null,
  "detection_latency_std_ms_mean": 0.0,
  "detection_latency_std_ms_std": 0.0,
  "detection_latency_std_ms_se": NaN,
  "detection_latency_std_ms_n": 1,
  "detection_latency_std_ms_95ci": null,
  "detection_latency_std_ms_ci_lower": null,
  "detection_latency_std_ms_ci_upper": null,
  "detection_rate_mean": 1.0,
  "detection_rate_std": 0.0,
  "detection_rate_se": NaN,
  "detection_rate_n": 1,
  "detection_rate_95ci": null,
  "detection_rate_ci_lower": null,
  "detection_rate_ci_upper": null,
  "detection_total_falls_mean": 11.0,
  "detection_total_falls_std": 0.0,
  "detection_total_falls_se": NaN,
  "detection_total_falls_n": 1,
  "detection_total_falls_95ci": null,
  "detection_total_falls_ci_lower": null,
  "detection_total_falls_ci_upper": null,
  "fall_f1_mean": 0.6842105263157895,
  "fall_f1_std": 0.0,
  "fall_f1_se": NaN,
  "fall_f1_n": 1,
  "fall_f1_95ci": null,
  "fall_f1_ci_lower": null,
  "fall_f1_ci_upper": null,
  "false_alarm_rate_mean": 0.9999999999999584,
  "false_alarm_rate_std": 0.0,
  "false_alarm_rate_se": NaN,
  "false_alarm_rate_n": 1,
  "false_alarm_rate_95ci": null,
  "false_alarm_rate_ci_lower": null,
  "false_alarm_rate_ci_upper": null,
  "g_mean_mean": 0.0,
  "g_mean_std": 0.0,
  "g_mean_se": NaN,
  "g_mean_n": 1,
  "g_mean_95ci": null,
  "g_mean_ci_lower": null,
  "g_mean_ci_upper": null,
  "macro_f1_mean": 0.34210526315789475,
  "macro_f1_std": 0.0,
  "macro_f1_se": NaN,
  "macro_f1_n": 1,
  "macro_f1_95ci": null,
  "macro_f1_ci_lower": null,
  "macro_f1_ci_upper": null,
  "mcc_mean": 0.0,
  "mcc_std": 0.0,
  "mcc_se": NaN,
  "mcc_n": 1,
  "mcc_95ci": null,
  "mcc_ci_lower": null,
  "mcc_ci_upper": null,
  "pr_auc_mean": 0.7033442446617859,
  "pr_auc_std": 0.0,
  "pr_auc_se": NaN,
  "pr_auc_n": 1,
  "pr_auc_95ci": null,
  "pr_auc_ci_lower": null,
  "pr_auc_ci_upper": null,
  "precision_mean": 0.26,
  "precision_std": 0.0,
  "precision_se": NaN,
  "precision_n": 1,
  "precision_95ci": null,
  "precision_ci_lower": null,
  "precision_ci_upper": null,
  "recall_macro_mean": 0.5,
  "recall_macro_std": 0.0,
  "recall_macro_se": NaN,
  "recall_macro_n": 1,
  "recall_macro_95ci": null,
  "recall_macro_ci_lower": null,
  "recall_macro_ci_upper": null,
  "roc_auc_mean": 0.7371794871794872,
  "roc_auc_std": 0.0,
  "roc_auc_se": NaN,
  "roc_auc_n": 1,
  "roc_auc_95ci": null,
  "roc_auc_ci_lower": null,
  "roc_auc_ci_upper": null,
  "sensitivity_mean": 1.0,
  "sensitivity_std": 0.0,
  "sensitivity_se": NaN,
  "sensitivity_n": 1,
  "sensitivity_95ci": null,
  "sensitivity_ci_lower": null,
  "sensitivity_ci_upper": null,
  "specificity_mean": 0.0,
  "specificity_std": 0.0,
  "specificity_se": NaN,
  "specificity_n": 1,
  "specificity_95ci": null,
  "specificity_ci_lower": null,
  "specificity_ci_upper": null
}
2025-12-18 21:27:56,076 - INFO - Logging initialized. Output directory: ./outputs
2025-12-18 21:27:57,978 - INFO - Optimized Config: {'dataset': 'dryrun', 'data_root': './data', 'out_dir': './outputs', 'model': 'dmc', 'epochs': 2, 'batch_size': 4, 'lr': 0.001, 'warmup_epochs': 5, 'accum_steps': 1, 'channels': 64, 'n_blocks': 4, 'kernel_sizes': [7, 15, 31, 63], 'freq_method': 'fft', 'fusion_variant': 'enhanced', 'fusion_kernel_sizes': (3, 5, 7), 'num_bands': 4, 'band_edges': None, 'adaptive_bands': True, 'attn_time': 'none', 'attn_freq': 'none', 'attn_fuse': 'none', 'attn_lite': 'none', 'faa_axis_attn': True, 'num_workers': 0, 'num_classes': 2, 'in_channels': 3, 'patience': 15, 'window_size': 512, 'stride': 256, 'channels_used': 'accel3', 'augment': False, 'noise_std': 0.05, 'scale_range': [0.9, 1.1], 'time_shift_ratio': 0.1, 'drop_prob': 0.1, 'eval_mode': 'holdout', 'seeds': [42], 'amp': False, 'weighted_loss': False, 'class_weighting': None, 'effective_num_beta': 0.999, 'profile': True, 'run_robustness': False, 'run_ablation_suite': False, 'allow_metrics_fallback': False, 'viz_tsne': False, 'viz_tsne_stage': 'final', 'viz_routing': False, 'viz_gradcam': False, 'loso_max_folds': None, 'deterministic': False, 'use_tfcl': False, 'ablation': {'mspa': True, 'dks': True, 'faa': True, 'tfcl': True, 'center': True}, 'proj_dim': 128, 'tf_temperature': 0.1, 'tf_supervised_weight': 0.1, 'tf_cross_weight': 0.3, 'tf_hierarchical': True, 'label_smoothing': 0.0, 'min_patience': 5, 'patience_decay': 0.9, 'loss_alpha': 0.1, 'loss_beta': 0.01, 'rocket_kernels': 256, 'rocket_kernel_size': 9, 'lstm_hidden': 128, 'stat_baseline': None, 'sample_rate': 50.0, 'cross_eval': False, 'resume': None}
2025-12-18 21:27:57,981 - INFO - Seed set to 42 (deterministic=False)
2025-12-18 21:27:58,474 - INFO - [main] Model: dmc
2025-12-18 21:27:58,475 - INFO - [main]   Total params: 0.25M
2025-12-18 21:27:58,475 - INFO - [main]   Trainable params: 0.25M
2025-12-18 21:28:02,414 - INFO - [main] Starting training: epochs=2, batch_size=4, num_workers=0, train_samples=200
2025-12-18 21:28:16,960 - DEBUG - Eval predictions unique: [1], counts: [ 0 50]
2025-12-18 21:28:16,960 - DEBUG - Eval labels unique: [0 1], counts: [20 30]
2025-12-18 21:28:16,964 - DEBUG - Eval confusion matrix:
[[ 0 20]
 [ 0 30]]
2025-12-18 21:28:16,965 - DEBUG - Manual metrics - Acc: 0.6000, Macro F1: 0.3750, Fall F1: 0.7500
2025-12-18 21:28:16,967 - DEBUG - Accuracy: 0.6000
2025-12-18 21:28:16,983 - DEBUG - F1 scores - Macro: 0.3750, Class0: 0.0000, Class1: 0.7500
2025-12-18 21:28:17,744 - INFO - [main] Seed 42 | Ep 1: Loss=0.7032 (ce=0.7032) Val_F1=0.3750 Best_F1=0.3750
2025-12-18 21:28:28,386 - DEBUG - Eval predictions unique: [1], counts: [ 0 50]
2025-12-18 21:28:28,387 - DEBUG - Eval labels unique: [0 1], counts: [20 30]
2025-12-18 21:28:28,390 - DEBUG - Eval confusion matrix:
[[ 0 20]
 [ 0 30]]
2025-12-18 21:28:28,391 - DEBUG - Manual metrics - Acc: 0.6000, Macro F1: 0.3750, Fall F1: 0.7500
2025-12-18 21:28:28,393 - DEBUG - Accuracy: 0.6000
2025-12-18 21:28:28,412 - DEBUG - F1 scores - Macro: 0.3750, Class0: 0.0000, Class1: 0.7500
2025-12-18 21:28:28,814 - INFO - [main] Seed 42 | Ep 2: Loss=0.6956 (ce=0.6956) Val_F1=0.3750 Best_F1=0.3750
2025-12-18 21:28:29,637 - INFO - [main] Loaded best checkpoint from epoch 1
2025-12-18 21:28:30,443 - DEBUG - Eval predictions unique: [1], counts: [ 0 50]
2025-12-18 21:28:30,444 - DEBUG - Eval labels unique: [0 1], counts: [24 26]
2025-12-18 21:28:30,445 - DEBUG - Eval confusion matrix:
[[ 0 24]
 [ 0 26]]
2025-12-18 21:28:30,446 - DEBUG - Manual metrics - Acc: 0.5200, Macro F1: 0.3421, Fall F1: 0.6842
2025-12-18 21:28:30,447 - DEBUG - Accuracy: 0.5200
2025-12-18 21:28:30,459 - DEBUG - F1 scores - Macro: 0.3421, Class0: 0.0000, Class1: 0.6842
2025-12-18 21:28:30,497 - INFO - [main] Seed 42 Test Results: {'accuracy': 0.52, 'specificity': 0.0, 'fall_f1': 0.6842105263157895, 'sensitivity': 1.0, 'macro_f1': 0.34210526315789475, 'recall_macro': 0.5, 'precision': 0.26, 'balanced_accuracy': 0.5, 'roc_auc': 0.7371794871794872, 'pr_auc': 0.7033442446617859, 'mcc': 0.0, 'g_mean': 0.0, 'false_alarm_rate': 0.9999999999999584, 'detection_latency_ms': 0.0, 'detection_latency_median_ms': 0.0, 'detection_latency_std_ms': 0.0, 'detection_latency_min_ms': 0.0, 'detection_latency_max_ms': 0.0, 'detection_rate': 1.0, 'detection_total_falls': 11, 'detection_detected_falls': 11}
2025-12-18 21:28:30,501 - INFO - Saved confusion matrix to ./outputs\confusion_matrix_seed42_main.npy
2025-12-18 21:28:30,502 - INFO - Saved error analysis to ./outputs\errors_seed42_main.csv
2025-12-18 21:28:39,201 - INFO - ------------------------------
2025-12-18 21:28:39,201 - INFO - [Efficiency Report] Input: (1, 3, 512)
2025-12-18 21:28:39,201 - INFO -   - Params: 0.25 M
2025-12-18 21:28:39,201 - INFO -   - FLOPs: 0.097 G
2025-12-18 21:28:39,202 - INFO -   - Latency: 68.339 ms
2025-12-18 21:28:39,202 - INFO - ------------------------------
2025-12-18 21:28:39,203 - INFO - Saved efficiency report to ./outputs\efficiency_seed42.json
2025-12-18 21:28:39,215 - INFO - Saved split stats to ./outputs\split_stats_seed42.json
2025-12-18 21:28:39,218 - INFO - Final Summary: {
  "accuracy_mean": 0.52,
  "accuracy_std": 0.0,
  "accuracy_se": NaN,
  "accuracy_n": 1,
  "accuracy_95ci": null,
  "accuracy_ci_lower": null,
  "accuracy_ci_upper": null,
  "balanced_accuracy_mean": 0.5,
  "balanced_accuracy_std": 0.0,
  "balanced_accuracy_se": NaN,
  "balanced_accuracy_n": 1,
  "balanced_accuracy_95ci": null,
  "balanced_accuracy_ci_lower": null,
  "balanced_accuracy_ci_upper": null,
  "detection_detected_falls_mean": 11.0,
  "detection_detected_falls_std": 0.0,
  "detection_detected_falls_se": NaN,
  "detection_detected_falls_n": 1,
  "detection_detected_falls_95ci": null,
  "detection_detected_falls_ci_lower": null,
  "detection_detected_falls_ci_upper": null,
  "detection_latency_max_ms_mean": 0.0,
  "detection_latency_max_ms_std": 0.0,
  "detection_latency_max_ms_se": NaN,
  "detection_latency_max_ms_n": 1,
  "detection_latency_max_ms_95ci": null,
  "detection_latency_max_ms_ci_lower": null,
  "detection_latency_max_ms_ci_upper": null,
  "detection_latency_median_ms_mean": 0.0,
  "detection_latency_median_ms_std": 0.0,
  "detection_latency_median_ms_se": NaN,
  "detection_latency_median_ms_n": 1,
  "detection_latency_median_ms_95ci": null,
  "detection_latency_median_ms_ci_lower": null,
  "detection_latency_median_ms_ci_upper": null,
  "detection_latency_min_ms_mean": 0.0,
  "detection_latency_min_ms_std": 0.0,
  "detection_latency_min_ms_se": NaN,
  "detection_latency_min_ms_n": 1,
  "detection_latency_min_ms_95ci": null,
  "detection_latency_min_ms_ci_lower": null,
  "detection_latency_min_ms_ci_upper": null,
  "detection_latency_ms_mean": 0.0,
  "detection_latency_ms_std": 0.0,
  "detection_latency_ms_se": NaN,
  "detection_latency_ms_n": 1,
  "detection_latency_ms_95ci": null,
  "detection_latency_ms_ci_lower": null,
  "detection_latency_ms_ci_upper": null,
  "detection_latency_std_ms_mean": 0.0,
  "detection_latency_std_ms_std": 0.0,
  "detection_latency_std_ms_se": NaN,
  "detection_latency_std_ms_n": 1,
  "detection_latency_std_ms_95ci": null,
  "detection_latency_std_ms_ci_lower": null,
  "detection_latency_std_ms_ci_upper": null,
  "detection_rate_mean": 1.0,
  "detection_rate_std": 0.0,
  "detection_rate_se": NaN,
  "detection_rate_n": 1,
  "detection_rate_95ci": null,
  "detection_rate_ci_lower": null,
  "detection_rate_ci_upper": null,
  "detection_total_falls_mean": 11.0,
  "detection_total_falls_std": 0.0,
  "detection_total_falls_se": NaN,
  "detection_total_falls_n": 1,
  "detection_total_falls_95ci": null,
  "detection_total_falls_ci_lower": null,
  "detection_total_falls_ci_upper": null,
  "fall_f1_mean": 0.6842105263157895,
  "fall_f1_std": 0.0,
  "fall_f1_se": NaN,
  "fall_f1_n": 1,
  "fall_f1_95ci": null,
  "fall_f1_ci_lower": null,
  "fall_f1_ci_upper": null,
  "false_alarm_rate_mean": 0.9999999999999584,
  "false_alarm_rate_std": 0.0,
  "false_alarm_rate_se": NaN,
  "false_alarm_rate_n": 1,
  "false_alarm_rate_95ci": null,
  "false_alarm_rate_ci_lower": null,
  "false_alarm_rate_ci_upper": null,
  "g_mean_mean": 0.0,
  "g_mean_std": 0.0,
  "g_mean_se": NaN,
  "g_mean_n": 1,
  "g_mean_95ci": null,
  "g_mean_ci_lower": null,
  "g_mean_ci_upper": null,
  "macro_f1_mean": 0.34210526315789475,
  "macro_f1_std": 0.0,
  "macro_f1_se": NaN,
  "macro_f1_n": 1,
  "macro_f1_95ci": null,
  "macro_f1_ci_lower": null,
  "macro_f1_ci_upper": null,
  "mcc_mean": 0.0,
  "mcc_std": 0.0,
  "mcc_se": NaN,
  "mcc_n": 1,
  "mcc_95ci": null,
  "mcc_ci_lower": null,
  "mcc_ci_upper": null,
  "pr_auc_mean": 0.7033442446617859,
  "pr_auc_std": 0.0,
  "pr_auc_se": NaN,
  "pr_auc_n": 1,
  "pr_auc_95ci": null,
  "pr_auc_ci_lower": null,
  "pr_auc_ci_upper": null,
  "precision_mean": 0.26,
  "precision_std": 0.0,
  "precision_se": NaN,
  "precision_n": 1,
  "precision_95ci": null,
  "precision_ci_lower": null,
  "precision_ci_upper": null,
  "recall_macro_mean": 0.5,
  "recall_macro_std": 0.0,
  "recall_macro_se": NaN,
  "recall_macro_n": 1,
  "recall_macro_95ci": null,
  "recall_macro_ci_lower": null,
  "recall_macro_ci_upper": null,
  "roc_auc_mean": 0.7371794871794872,
  "roc_auc_std": 0.0,
  "roc_auc_se": NaN,
  "roc_auc_n": 1,
  "roc_auc_95ci": null,
  "roc_auc_ci_lower": null,
  "roc_auc_ci_upper": null,
  "sensitivity_mean": 1.0,
  "sensitivity_std": 0.0,
  "sensitivity_se": NaN,
  "sensitivity_n": 1,
  "sensitivity_95ci": null,
  "sensitivity_ci_lower": null,
  "sensitivity_ci_upper": null,
  "specificity_mean": 0.0,
  "specificity_std": 0.0,
  "specificity_se": NaN,
  "specificity_n": 1,
  "specificity_95ci": null,
  "specificity_ci_lower": null,
  "specificity_ci_upper": null
}
2025-12-18 21:28:58,686 - INFO - Logging initialized. Output directory: ./outputs
2025-12-18 21:29:00,086 - INFO - Optimized Config: {'dataset': 'dryrun', 'data_root': './data', 'out_dir': './outputs', 'model': 'dmc', 'epochs': 1, 'batch_size': 4, 'lr': 0.001, 'warmup_epochs': 5, 'accum_steps': 1, 'channels': 64, 'n_blocks': 4, 'kernel_sizes': [7, 15, 31, 63], 'freq_method': 'fft', 'fusion_variant': 'enhanced', 'fusion_kernel_sizes': (3, 5, 7), 'num_bands': 4, 'band_edges': None, 'adaptive_bands': True, 'attn_time': 'none', 'attn_freq': 'none', 'attn_fuse': 'none', 'attn_lite': 'none', 'faa_axis_attn': True, 'num_workers': 0, 'num_classes': 2, 'in_channels': 3, 'patience': 15, 'window_size': 512, 'stride': 256, 'channels_used': 'accel3', 'augment': False, 'noise_std': 0.05, 'scale_range': [0.9, 1.1], 'time_shift_ratio': 0.1, 'drop_prob': 0.1, 'eval_mode': 'holdout', 'seeds': [42], 'amp': False, 'weighted_loss': False, 'class_weighting': None, 'effective_num_beta': 0.999, 'profile': False, 'run_robustness': False, 'run_ablation_suite': False, 'allow_metrics_fallback': False, 'viz_tsne': False, 'viz_tsne_stage': 'final', 'viz_routing': False, 'viz_gradcam': False, 'loso_max_folds': None, 'deterministic': False, 'use_tfcl': False, 'ablation': {'mspa': True, 'dks': True, 'faa': True, 'tfcl': True, 'center': True}, 'proj_dim': 128, 'tf_temperature': 0.1, 'tf_supervised_weight': 0.1, 'tf_cross_weight': 0.3, 'tf_hierarchical': True, 'label_smoothing': 0.0, 'min_patience': 5, 'patience_decay': 0.9, 'loss_alpha': 0.1, 'loss_beta': 0.01, 'rocket_kernels': 256, 'rocket_kernel_size': 9, 'lstm_hidden': 128, 'stat_baseline': None, 'sample_rate': 50.0, 'cross_eval': False, 'resume': None}
2025-12-18 21:29:00,088 - INFO - Seed set to 42 (deterministic=False)
2025-12-18 21:29:00,518 - INFO - [main] Model: dmc
2025-12-18 21:29:00,518 - INFO - [main]   Total params: 0.25M
2025-12-18 21:29:00,518 - INFO - [main]   Trainable params: 0.25M
2025-12-18 21:29:04,351 - INFO - [main] Starting training: epochs=1, batch_size=4, num_workers=0, train_samples=200
2025-12-18 21:29:18,317 - DEBUG - Eval predictions unique: [1], counts: [ 0 50]
2025-12-18 21:29:18,318 - DEBUG - Eval labels unique: [0 1], counts: [20 30]
2025-12-18 21:29:18,322 - DEBUG - Eval confusion matrix:
[[ 0 20]
 [ 0 30]]
2025-12-18 21:29:18,323 - DEBUG - Manual metrics - Acc: 0.6000, Macro F1: 0.3750, Fall F1: 0.7500
2025-12-18 21:29:18,324 - DEBUG - Accuracy: 0.6000
2025-12-18 21:29:18,344 - DEBUG - F1 scores - Macro: 0.3750, Class0: 0.0000, Class1: 0.7500
2025-12-18 21:29:19,047 - INFO - [main] Seed 42 | Ep 1: Loss=0.7032 (ce=0.7032) Val_F1=0.3750 Best_F1=0.3750
2025-12-18 21:29:19,915 - INFO - [main] Loaded best checkpoint from epoch 1
2025-12-18 21:29:20,727 - DEBUG - Eval predictions unique: [1], counts: [ 0 50]
2025-12-18 21:29:20,727 - DEBUG - Eval labels unique: [0 1], counts: [24 26]
2025-12-18 21:29:20,730 - DEBUG - Eval confusion matrix:
[[ 0 24]
 [ 0 26]]
2025-12-18 21:29:20,730 - DEBUG - Manual metrics - Acc: 0.5200, Macro F1: 0.3421, Fall F1: 0.6842
2025-12-18 21:29:20,732 - DEBUG - Accuracy: 0.5200
2025-12-18 21:29:20,747 - DEBUG - F1 scores - Macro: 0.3421, Class0: 0.0000, Class1: 0.6842
2025-12-18 21:29:20,785 - INFO - [main] Seed 42 Test Results: {'accuracy': 0.52, 'specificity': 0.0, 'fall_f1': 0.6842105263157895, 'sensitivity': 1.0, 'macro_f1': 0.34210526315789475, 'recall_macro': 0.5, 'precision': 0.26, 'balanced_accuracy': 0.5, 'roc_auc': 0.7371794871794872, 'pr_auc': 0.7033442446617859, 'mcc': 0.0, 'g_mean': 0.0, 'false_alarm_rate': 0.9999999999999584, 'detection_latency_ms': 0.0, 'detection_latency_median_ms': 0.0, 'detection_latency_std_ms': 0.0, 'detection_latency_min_ms': 0.0, 'detection_latency_max_ms': 0.0, 'detection_rate': 1.0, 'detection_total_falls': 11, 'detection_detected_falls': 11}
2025-12-18 21:29:20,788 - INFO - Saved confusion matrix to ./outputs\confusion_matrix_seed42_main.npy
2025-12-18 21:29:20,790 - INFO - Saved error analysis to ./outputs\errors_seed42_main.csv
2025-12-18 21:29:20,802 - INFO - Saved split stats to ./outputs\split_stats_seed42.json
2025-12-18 21:29:20,805 - INFO - Final Summary: {
  "accuracy_mean": 0.52,
  "accuracy_std": 0.0,
  "accuracy_se": NaN,
  "accuracy_n": 1,
  "accuracy_95ci": null,
  "accuracy_ci_lower": null,
  "accuracy_ci_upper": null,
  "balanced_accuracy_mean": 0.5,
  "balanced_accuracy_std": 0.0,
  "balanced_accuracy_se": NaN,
  "balanced_accuracy_n": 1,
  "balanced_accuracy_95ci": null,
  "balanced_accuracy_ci_lower": null,
  "balanced_accuracy_ci_upper": null,
  "detection_detected_falls_mean": 11.0,
  "detection_detected_falls_std": 0.0,
  "detection_detected_falls_se": NaN,
  "detection_detected_falls_n": 1,
  "detection_detected_falls_95ci": null,
  "detection_detected_falls_ci_lower": null,
  "detection_detected_falls_ci_upper": null,
  "detection_latency_max_ms_mean": 0.0,
  "detection_latency_max_ms_std": 0.0,
  "detection_latency_max_ms_se": NaN,
  "detection_latency_max_ms_n": 1,
  "detection_latency_max_ms_95ci": null,
  "detection_latency_max_ms_ci_lower": null,
  "detection_latency_max_ms_ci_upper": null,
  "detection_latency_median_ms_mean": 0.0,
  "detection_latency_median_ms_std": 0.0,
  "detection_latency_median_ms_se": NaN,
  "detection_latency_median_ms_n": 1,
  "detection_latency_median_ms_95ci": null,
  "detection_latency_median_ms_ci_lower": null,
  "detection_latency_median_ms_ci_upper": null,
  "detection_latency_min_ms_mean": 0.0,
  "detection_latency_min_ms_std": 0.0,
  "detection_latency_min_ms_se": NaN,
  "detection_latency_min_ms_n": 1,
  "detection_latency_min_ms_95ci": null,
  "detection_latency_min_ms_ci_lower": null,
  "detection_latency_min_ms_ci_upper": null,
  "detection_latency_ms_mean": 0.0,
  "detection_latency_ms_std": 0.0,
  "detection_latency_ms_se": NaN,
  "detection_latency_ms_n": 1,
  "detection_latency_ms_95ci": null,
  "detection_latency_ms_ci_lower": null,
  "detection_latency_ms_ci_upper": null,
  "detection_latency_std_ms_mean": 0.0,
  "detection_latency_std_ms_std": 0.0,
  "detection_latency_std_ms_se": NaN,
  "detection_latency_std_ms_n": 1,
  "detection_latency_std_ms_95ci": null,
  "detection_latency_std_ms_ci_lower": null,
  "detection_latency_std_ms_ci_upper": null,
  "detection_rate_mean": 1.0,
  "detection_rate_std": 0.0,
  "detection_rate_se": NaN,
  "detection_rate_n": 1,
  "detection_rate_95ci": null,
  "detection_rate_ci_lower": null,
  "detection_rate_ci_upper": null,
  "detection_total_falls_mean": 11.0,
  "detection_total_falls_std": 0.0,
  "detection_total_falls_se": NaN,
  "detection_total_falls_n": 1,
  "detection_total_falls_95ci": null,
  "detection_total_falls_ci_lower": null,
  "detection_total_falls_ci_upper": null,
  "fall_f1_mean": 0.6842105263157895,
  "fall_f1_std": 0.0,
  "fall_f1_se": NaN,
  "fall_f1_n": 1,
  "fall_f1_95ci": null,
  "fall_f1_ci_lower": null,
  "fall_f1_ci_upper": null,
  "false_alarm_rate_mean": 0.9999999999999584,
  "false_alarm_rate_std": 0.0,
  "false_alarm_rate_se": NaN,
  "false_alarm_rate_n": 1,
  "false_alarm_rate_95ci": null,
  "false_alarm_rate_ci_lower": null,
  "false_alarm_rate_ci_upper": null,
  "g_mean_mean": 0.0,
  "g_mean_std": 0.0,
  "g_mean_se": NaN,
  "g_mean_n": 1,
  "g_mean_95ci": null,
  "g_mean_ci_lower": null,
  "g_mean_ci_upper": null,
  "macro_f1_mean": 0.34210526315789475,
  "macro_f1_std": 0.0,
  "macro_f1_se": NaN,
  "macro_f1_n": 1,
  "macro_f1_95ci": null,
  "macro_f1_ci_lower": null,
  "macro_f1_ci_upper": null,
  "mcc_mean": 0.0,
  "mcc_std": 0.0,
  "mcc_se": NaN,
  "mcc_n": 1,
  "mcc_95ci": null,
  "mcc_ci_lower": null,
  "mcc_ci_upper": null,
  "pr_auc_mean": 0.7033442446617859,
  "pr_auc_std": 0.0,
  "pr_auc_se": NaN,
  "pr_auc_n": 1,
  "pr_auc_95ci": null,
  "pr_auc_ci_lower": null,
  "pr_auc_ci_upper": null,
  "precision_mean": 0.26,
  "precision_std": 0.0,
  "precision_se": NaN,
  "precision_n": 1,
  "precision_95ci": null,
  "precision_ci_lower": null,
  "precision_ci_upper": null,
  "recall_macro_mean": 0.5,
  "recall_macro_std": 0.0,
  "recall_macro_se": NaN,
  "recall_macro_n": 1,
  "recall_macro_95ci": null,
  "recall_macro_ci_lower": null,
  "recall_macro_ci_upper": null,
  "roc_auc_mean": 0.7371794871794872,
  "roc_auc_std": 0.0,
  "roc_auc_se": NaN,
  "roc_auc_n": 1,
  "roc_auc_95ci": null,
  "roc_auc_ci_lower": null,
  "roc_auc_ci_upper": null,
  "sensitivity_mean": 1.0,
  "sensitivity_std": 0.0,
  "sensitivity_se": NaN,
  "sensitivity_n": 1,
  "sensitivity_95ci": null,
  "sensitivity_ci_lower": null,
  "sensitivity_ci_upper": null,
  "specificity_mean": 0.0,
  "specificity_std": 0.0,
  "specificity_se": NaN,
  "specificity_n": 1,
  "specificity_95ci": null,
  "specificity_ci_lower": null,
  "specificity_ci_upper": null
}
